# TriggerGameCompose

## テスト方法

### websocketクライアントでの接続テスト

```bash
# (前提)websocatのインストール
npm install -g wscat

# WebSocketサーバーに接続
wscat -c ws://localhost:8080

# クラウド
wscat -c wss://y0kc9gtshi.execute-api.ap-northeast-1.amazonaws.com/Prod/

# 接続後、対話的にメッセージを送信
{"action": "matchmaking", "player_id": "212df6af-6345-46a3-b7fe-d1d892ae0f2d"}
{"type": "ping"}
```

## Dockerコマンド

```bash
# Dockerコンテナの起動
docker compose up --build

# composeの停止と関連コンテナの削除
docker compose down
```

## ツール

### VSCode拡張機能

* todo-tree

## タスクリスト

* [x] プレイヤーidとクライアントIDの保存機能実装
* [x] プレイヤーidからクライアントIDを取得する機能実装
* [x] ユニット管理にゲームidを追加
* [x] マッチIDとゲームIDってどちらも必要？？（triggergame-simulator）
        -> マッチIDをゲームIDに統一する方向で実装
* [x] マッチングに移行した段階でユニットの初期状態をテーブルに登録
  * [x] 現在装備しているトリガーも含めて取得する
* [x] マッチング完了のレスポンスにユニット情報を含める
  * [x] 味方キャラのフロント情報作成と敵情報作成機能を入れる 
  * [x] ユニットがBAGWORMをそうびしている場合は不可視とする
* [x] マッチング完了時にゲーム状態をリポジトリに登録する
  * [x] ゲーム状態を保存するリポジトリを作成
* [ ] 受け取った初期ゲーム情報をもとにゲーム画面を作成
      -> ほんとはゲーム画面のURLパスでゲームIDを取得してwsのメッセージで情報取得が一番いいと思うけど。。
         現時点では保留。後で実装。
* [x] フロント側のキャラクター操作->サーバーへのリクエストまでの実装
* [x] サーバー側でのターン処理シーケンスの実装
  * [x] ターン内の操作をリクエストしたあとのシーケンスを作成
* [x] Action/Stepのエンティティを使ってフロントエンドのゲームロジック改善
* [x] 集積したAction/Stepの情報をサーバーにプッシュする機能の実装
* [x] サーバー側でAction/Stepの情報を受け取ってゲーム状態を更新する機能の修正（多分すぐは動かないだろう・・）
  * [ ] 15秒で1ターン終了のロジックを入れる
* [ ] サーバーから受け取ったターン情報でゲーム画面を更新する機能の実装
* [ ] ゲーム終了時のロジック作成
